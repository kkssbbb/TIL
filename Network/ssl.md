# SSL(TSL)

SSL(Secure Socket Layer) - μ›Ή ν†µμ‹  λ³΄μ•μ„ μ„ν•΄ μµμ΄λ΅ λ§λ“¤μ–΄μ§.

TSL(Transport Layer Security) - ν„μ¬ μ‚¬μ©λλ” μ •μ‹λ…μΉ­μ€ TSL μ΄λ‹¤.

SSL TSL κ°™μ€ μλ―Έ TSL 1.0μ€ SSL3.0μ„ κ³„μΉν•λ‹¤.

μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„ μ•”νΈν™” ν†µμ‹ μ„ μ§€μ›ν•λ‹¤.

SSL ν•µμ‹¬μ€ μ•”νΈν™”

SSLμ€ λ³΄μ•κ³Ό μ„±λ¥μƒμ μ΄μ λ΅ λ‘κ°€μ§€ μ•”νΈν™” κΈ°λ²• νΌμ©ν•¨

- λ€μΉ­ν‚¤
- κ³µκ°ν‚¤

SSL λ™μ‘ λ°©λ²• μ΄ν•΄λ¥Ό μ„ν•΄μ„λ” μ΄ λ‘κ°€μ§€ μ•”νΈν™” κΈ°λ²• μ΄ν•΄ ν•„μ”(μ΄ν•΄μ—†μΌλ©΄ λ™μ‘λ°©μ‹μ΄ μ¶”μƒμ μΌλ΅ λκ»΄μ§)

---

# λ€μΉ­ν‚¤

- μ•”νΈν™” ν• λΉλ°€λ²νΈλ¥Ό KeyλΌκ³  ν•λ‹¤.
- ν‚¤λ¥Ό λ¨λ¥΄λ©΄ λ³µνΈν™” λ¶κ°€λ¥ ν•λ‹¤.

λ‹¨μ 

- μ•”νΈλ¥Ό μ£Όκ³  λ°›λ” μ‚¬λλ“¤ μ‚¬μ΄μ— λ€μΉ­ν‚¤ μ „λ‹¬ μ–΄λ ¤μ›€
- λ€μΉ­ν‚¤ μ μ¶μ‹ μ•”νΈν™” λ‚΄μ©μ„ λ³µνΈν™” κ°€λ¥ν•κΈ°λ•λ¬Έμ— ν•¨νΈν™”λ” λ¬΄μ©μ§€λ¬Όμ΄λλ‹¤.
- μ΄λ° λ‹¨μ μΌλ΅ κ³µκ°ν‚¤ λ°©μ‹μ΄ λ‚μ΄

```bash
#openssl μ„ μ΄μ©ν• λ€μΉ­ν‚¤ λ°©μ‹ μ•”νΈν™”
#test.txt νμΌ μƒμ„±
echo 'νμΌ λ‚΄μ© μ‘μ„±' > text.txt;

openssl enc -e -des3 -salt -in test.txt -out ssl_text.txt;
```

- enc -e -des3 : des3 λ°©μ‹μΌλ΅ μ•”νΈν™”
- -in μ•”νΈν™”ν•  νμΌλ… -out μ•”νΈν™”ν• νμΌ μ €μ¥ν•  μ΄λ¦„
- λΉ„λ°€λ²νΈ μ”κµ¬μ‹ μ…λ ¥ν• λΉ„λ°€λ²νΈκ°€ λ€μΉ­ν‚¤κ°€ λλ‹¤.

```bash
#λ³µνΈν™”
openssl enc -d -des3 -in ssl_text.txt -out dessl_text.txt;
```

- end -d μµμ…μΌλ΅ ssl_text.txt νμΌ dessl_text.txt νμΌλ΅ λ³µνΈν™”

# κ³µκ°ν‚¤

- κ³µκ°ν‚¤λ” λ‘ κ°μ ν‚¤λ¥Ό κ°–κ² λλ‹¤.
  - Aν‚¤λ΅ μ•”νΈν™”λ¥Ό ν•λ©΄ Bν‚¤λ΅ λ³µνΈν™”λ¥Ό ν•  μ μκ³ , Bν‚¤λ΅ μ•”νΈν™”ν•λ©΄ Aν‚¤λ΅ λ³µνΈν™” ν•  μ μλ” λ°©μ‹.
  - λ‘ κ°μ ν‚¤ μ¤‘ ν•λ‚λ¥Ό λΉ„κ³µκ° ν‚¤(private key) κ°μΈ ν‚¤, λΉ„λ°€ ν‚¤λΌκ³  λ¶€λ¥Έλ‹¤.
  - λ‚λ¨Έμ§€ ν‚¤λ” κ³µκ°ν‚¤(public key)λ΅ μ§€μ •ν•λ‹¤.
- λΉ„κ³µκ° ν‚¤λ” μμ‹ λ§ κ°–κ³  μκ³  κ³µκ°ν‚¤λ¥Ό νƒ€μΈμ—κ² μ κ³µν•λ‹¤.

## λ™μ‘ λ°©μ‹

1. κ³µκ°ν‚¤λ¥Ό μ κ³µ λ°›μ€ νƒ€μΈμ€ κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄μ„ μ •λ³΄λ¥Ό μ•”νΈν™” ν•λ‹¤.
2. μ•”νΈν™”ν• μ •λ³΄λ¥Ό λΉ„κ³µκ° ν‚¤λ¥Ό κ°–κ³  μλ” μ‚¬λμ—κ² μ „μ†΅ν•λ‹¤.
3. λΉ„κ³µκ° ν‚¤λ¥Ό κ°–κ³  μλ” μ‚¬λμ€ μ΄ ν‚¤λ¥Ό μ΄μ©ν•΄μ„ μ•”νΈν™”λ μ •λ³΄λ¥Ό λ³µνΈν™” ν•λ‹¤.

- μ΄ κ³Όμ •μ—μ„ κ³µκ°ν‚¤κ°€ μ μ¶ λΌλ„ λΉ„κ³µκ° ν‚¤λ¥Ό λ¨λ¥΄λ©΄ λ³µνΈν™”λ¥Ό ν•  μ μ—†κΈ° λ–„λ¬Έμ— μ•μ „ν•λ‹¤.

## μ‘μ© λ°©μ‹

1. λΉ„κ³µκ° ν‚¤ μ†μ μ λΉ„κ³µκ° ν‚¤λ΅ μ •λ³΄ μ•”νΈν™” ν›„ κ³µκ°ν‚¤μ™€ ν•¨κ» μ•”νΈν™”λ μ •λ³΄ μ „μ†΅
2. μ•”νΈν™”λ μ •λ³΄μ™€ κ³µκ°ν‚¤λ¥Ό λ°›μ€ μ‚¬λμ€ κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄μ„ μ•”νΈν™”λ μ •λ³΄λ¥Ό λ³µνΈν™” ν•λ‹¤.

- μ΄ κ³Όμ •μ—μ„ κ³µκ°ν‚¤ μ μ¶ μ„ν—μ΄ μλ”λ° λΉ„κ³µκ° ν‚¤λ¥Ό μ΄μ©ν•΄μ„ μ•”νΈν™”λ¥Ό ν•λ” μ΄μ λ” λ°μ΄ν„°λ¥Ό λ³΄νΈν•λ” λ©μ μ΄ μ•„λ‹κΈ° λ•λ¬Έμ΄λ‹¤.
- μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό κ³µκ°ν‚¤λ¥Ό κ°€μ§€κ³  λ³µνΈν™”λ¥Ό ν•  μ μλ‹¤λ” κ²ƒμ€ κ·Έ λ°μ΄ν„°κ°€ κ³µκ°ν‚¤μ™€ μμ„ μ΄λ£¨λ” λΉ„κ³µκ° ν‚¤μ— μν•΄μ„ μ•”νΈν™” λμ—λ‹¤λ” κ²ƒμ„ μλ―Έν•λ‹¤.
- μ¦‰ κ³µκ°ν‚¤ λ°μ΄ν„°λ¥Ό μ κ³µν• μ‚¬λμ μ‹ μ›μ„ λ³΄μ¥ν•΄μ£Όκ² λλ‹¤. μ΄λ¬ν• κ²ƒμ„ μ „μ μ„λ… μ΄λΌκ³  λ¶€λ¥Έλ‹¤.

## RSA λ°©μ‹ κ³µκ°ν‚¤ μ‚¬μ© μμ 

```bash
# private_key.pem μ μ΄λ¦„μΌλ΅ 1024bit ν¬κΈ°μ λΉ„κ³µκ° ν‚¤ μƒμ„±
openssl genrsa -out private_key.pem 1024;

# rsa λ°©μ‹μΌλ΅ private_key.pem μ λΉ„κ³µκ° ν‚¤μ— λ€ν• public_key.pem μ μ΄λ¦„μΌλ΅ κ³µκ° ν‚¤ μƒμ„±
# λ§λ“¤μ–΄μ§„ κ³µκ°ν‚¤λ¥Ό μμ‹ μ—κ² μ •λ³΄λ¥Ό μ κ³µν•  μ‚¬λμ—κ² μ „μ†΅ν•λ©΄ λλ‹¤.
openssl rsa -in private_key.pem -out public_key.pem -outform PEM -pubout;

# κ³µκ°ν‚¤λ¥Ό κ°€μ§„μ‚¬λμ΄ μ–΄λ–¤μ •λ³΄λ¥Ό λΉ„κ³µκ°ν‚¤λ¥Ό κ°–κ³  μλ” μ‚¬λμ—κ² μ „μ†΅ν•λ” μƒν™© κ°€μ •

# μ•”νΈν™” ν•  νμΌ μƒμ„±
echo 'μ•”νΈν™” ν•  λ‚΄μ©' > secret_text.txt

# μƒμ„±ν• νμΌμ„ μ•”νΈν™” ν• ν›„ λΉ„κ³µκ°ν‚¤ μ†μ μμ—κ² μ „μ†΅
# κ³µκ°ν‚¤ public_key.pemλ¥Ό μ‚¬μ©ν•΄μ„ secret_text.txt λ‚΄μ©μ„ RSAλ°©μ‹μΌλ΅ μ•”νΈν™” ν•ν›„ ssl_data.sslλ΅ μ €μ¥
openssl rsautl -encrypt -inkey public_key.pem -pubin -in secret_text.txt -out ssl_data.ssl;

# μ•”νΈν™”λ ssl_data.sslμ„ λ°›μ€ λΉ„κ³µκ°ν‚¤ μ†μ μκ°€ μ•”νΈν™”ν•λ” κ³Όμ •
# λΉ„κ³µκ°ν‚¤ privatre_key.pem μ„ μ΄μ©ν•΄μ„ μ•”νΈν™”λ νμΌμΈ ssl_data.ssl μ„ de_ssl_data.txt νμΌλ΅ λ³µνΈν™”
openssl rsautl -decrypt -inkey private_key.pem -in ssl_data.ssl -out de_ssl_data.txt
```

---

# SSL μΈμ¦μ„

ν•µμ‹¬

1. ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν• μ„λ²„κ°€ μ‹ λΆ° ν•  μ μλ” μ„λ²„μ„μ„ λ³΄μ¥
2. SSL ν†µμ‹ μ— μ‚¬μ©ν•  κ³µκ°ν‚¤λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² μ κ³µν•λ‹¤.

# μ»΄ν“¨ν„° λ„¤νΈμ›ν¬ ν†µμ‹  μ¤‘ SSL μ „λ‹¬ κ³Όμ •

ν•Έλ“μ‰μ΄ν¬ β†’ μ „μ†΅ β†’ μ„Έμ… μΆ…λ£

# π“1. SSL Hendshake

- SSL ν•Έλ“μ‰μ΄ν¬λ” TCP μ—°κ²°μ΄ μ„±λ¦½λ μƒνƒμ—μ„ μ§„ν–‰λλ‹¤.

- CAλ€?
  - ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν• μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈκ°€ μλ„ν• μ„λ²„κ°€ λ§λ”μ§€ λ³΄μ¥ν•λ” μ—­ν• μ„ ν•λ” λ―Όκ°„ κΈ°μ—…μ„ CA(Certificate authority) λΌκ³  λ¶€λ¥Έλ‹¤.
  - CAλ” μ‹ λΆ°μ„±μ΄ μ—„κ²©ν•κ² κ³µμΈλ κΈ°μ—…λ“¤λ§ μ°Έμ—¬ κ°€λ¥ν•λ‹¤.

![ssl Step λ„μ‹ν™”.png](<SSL(TSL)%203d7dc9f4dc0240349821d0e3f6927bd3/ssl_Step_%25EB%258F%2584%25EC%258B%259D%25ED%2599%2594.png>)

## 1. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„(Client Hello) κ³Όμ •μ—μ„ μ£Όκ³  λ°›λ” λ°μ΄ν„°λ“¤

**λλ¤λ°μ΄ν„°**

- ν΄λΌμ΄μ–ΈνΈμ—μ„ λ§λ“  λλ¤ λ°μ΄ν„°λ¥Ό μ„λ²„μ— μ „μ†΅ν•λ‹¤.

**μ•”νΈν™” λ°©μ‹**

- ν΄λΌμ΄μ–ΈνΈμ—μ„ μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹λ“¤ μ„λ²„μ— μ „μ†΅
- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹μ΄ μ„λ΅ λ‹¤λ¥Ό μ μμμΌλ΅ μ–΄λ–¤ μ•”νΈν™” λ°©μ‹μ„ μ‚¬μ©ν•  κ²ƒμΈμ§€ λ¨Όμ € μ •ν•λ” κ³Όμ •

**μ„Έμ…μ•„μ΄λ””**

- SSL ν•Έλ“ μ‰μ΄ν‚Ήμ„ μ΄λ―Έ ν• μƒνƒμ΄λ©΄ λΉ„μ©κ³Ό μ‹κ°„ μ μ•½μ„ μ„ν•΄ κΈ°μ΅΄ μ„Έμ…μ„ μ¬ν™μ©ν•λ”λ° μ΄λ• μ‚¬μ©ν•  μ—°κ²°μ— λ€ν• μ‹λ³„μλ¥Ό μ„λ²„μ— μ „λ‹¬ν•λ‹¤.

## 2. μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ (Server Hello) κ³Όμ •μ—μ„ μ£Όκ³  λ°›λ” λ°μ΄ν„°λ“¤

**λλ¤λ°μ΄ν„°**

- μ„λ²„μ—μ„ λ§λ“  λλ¤ λ°μ΄ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•λ‹¤.

**μ•”νΈν™”λ°©μ‹**

- ν΄λΌμ΄μ–ΈνΈκ°€ μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹μ¤‘μ—μ„ μ„λ²„μ—μ„ μ‚¬μ©κ°€λ¥ν• μ•”νΈν™” λ°©μ‹μ„ μ„ νƒν•΄ ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•λ‹¤.

**SSL μΈμ¦μ„**

- μΈμ¦μ„μ—λ” κ³µκ°ν‚¤, CA(μΈμ¦μ„ λ°κΈ‰μ) λ“±μ΄ ν¬ν•¨λμ–΄ μλ‹¤.

## 3. ν΄λΌμ΄μ–ΈνΈ CA(κ³µμΈ/μ‚¬μ„¤) List check

**μΈμ¦μ„**

- μ„λ²„μ—μ„Έ λ°›μ€ μΈμ¦μ„λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ‚΄μ¥λ CAλ¦¬μ¤νΈλ¥Ό ν™•μΈν•λ‹¤.
- CA λ¦¬μ¤νΈμ— μ—†λ‹¤λ©΄, κ²½κ³  λ©”μ„Έμ§€ μ¶λ ¥
- CA λ¦¬μ¤νΈμ— μλ‹¤λ©΄, ν΄λΌμ΄μ–ΈνΈμ— λ‚΄μ¥λ CA κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄ μΈμ¦μ„λ¥Ό λ³µνΈν™”λ¥Ό μ„±κ³µ ν–λ‹¤λ” κ²ƒμ΄λ‹¤. λ”°λΌμ„ μΈμ¦μ„λ¥Ό μ „μ†΅ν• μ„λ²„λ¥Ό λ―Ώμ„ μ μκ² λλ‹¤.

**μ„μ‹ν‚¤ (pre master secret) μƒμ„±**

- μ΄μ „ κ³Όμ •μ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ£Όκ³ λ°›μ€ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈμ λλ¤λ°μ΄ν„°λ¥Ό μ΅°ν•©ν•΄μ„ pre master secret ν‚¤λ¥Ό μƒμ„±ν•λ‹¤.
- ν•Έλ“ μ‰μ΄ν‚Ήμ΄ λλ‚κ³  μ„Έμ… λ‹¨κ³„μ—μ„ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μ„ λ• μ•”νΈν™” ν•κΈ°μ„ν•΄μ„ μ‚¬μ©λλ” ν‚¤μ΄λ‹¤.
- μ„μ‹ν‚¤λ” λ€μΉ­ν‚¤ μ΄κΈ°λ•λ¬Έμ— ν‚¤ κ°’μ΄ λ…Έμ¶λμ„λ” μ λ€ μ•λλ‹¤.

## 4. ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„(μ„μ‹ν‚¤ μ „λ‹¬)

**pre master secret κ°’ μ „λ‹¬**

- μ„λ²„λ΅λ¶€ν„° λ°›μ€ μΈμ¦μ„ μ•μ— μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄ pre master secret κ°’μ„ μ•”νΈν™”ν• ν›„ μ„λ²„μ— μ „μ†΅ ν•λ‹¤.
- μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈλ΅ λ¶€ν„° λ°›μ€ pre master secret κ°’μ„ λΉ„κ³µκ°ν‚¤λ΅ λ³µνΈν™” ν•λ‹¤.
- μ„λ²„ ν΄λΌμ΄μ–ΈνΈ μ„μ‹ν‚¤(pre master sectet)κ°’ κ³µμ  μ™„λ£
- μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ” μΌλ ¨μ κ³Όμ •μ„ κ±°μ²μ„ μµμΆ… ν‚¤(master secret)κ°’μΌλ΅ λ§λ“ λ‹¤.
- μµμΆ… ν‚¤λ” μ„Έμ…ν‚¤(λ€μΉ­ν‚¤)λ¥Ό μƒμ„±ν•κ³  μ„Έμ…ν‚¤ κ°’μ„ μ΄μ©ν•΄μ„ λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ μ•”νΈν™” ν• ν›„μ— λ°μ΄ν„°λ¥Ό μ£Όκ³  λ°›λ”λ‹¤.
- ν΄λΌμ΄μ–ΈνΈ μ„λ²„ ν•Έλ“ μ‰μ΄ν¬ μΆ…λ£λ¥Ό μ„λ΅μ—κ² μ•λ¦°λ‹¤.

## 5. μ„Έμ…

- μ„Έμ… λ‹¨κ³„μ—μ„λ” μ„Έμ…ν‚¤λ¥Ό ν™μ©ν• λ€μΉ­ν‚¤ μ•”νΈν™”λ°©μ‹ ν†µμ‹ 

## 6 μ„Έμ… μΆ…λ£

- μ„Έμ… μΆ…λ£ sslν†µμ‹ μ΄ λλ‚¬μμ„ μ•λ¦¬κ³  ν†µμ‹ ν•λ©΄μ„ μ‚¬μ©ν• λ€μΉ­ ν‚¤μΈ μ„Έμ…ν‚¤λ¥Ό νκΈ°ν•λ‹¤.

reference

[μ°Έκ³ ](https://opentutorials.org/course/228/4894)

[https://coconuts.tistory.com/773](https://coconuts.tistory.com/773)

[https://it-sunny-333.tistory.com/144](https://it-sunny-333.tistory.com/144)

[https://wayhome25.github.io/cs/2018/03/11/ssl-https/](https://wayhome25.github.io/cs/2018/03/11/ssl-https/)
