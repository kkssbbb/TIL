# ëª©ì°¨
- ğŸ“Œí™ˆ í™”ë©´
    - ğŸ‘€ íšŒì› ê¸°ëŠ¥
    - ğŸ‘€ íšŒì› ë“±ë¡
    - ğŸ‘€ íšŒì› ì¡°íšŒ
- ğŸ“Œìƒí’ˆ ê¸°ëŠ¥
    - ğŸ‘€ ìƒí’ˆ ë“±ë¡
    - ğŸ‘€ ìƒí’ˆ ìˆ˜ì •
    - ğŸ‘€ ìƒí’ˆ ì¡°íšŒ
- ğŸ“Œì£¼ë¬¸ ê¸°ëŠ¥
    - ğŸ‘€ ìƒí’ˆ ì£¼ë¬¸
    - ğŸ‘€ ì£¼ë¬¸ ë‚´ì—­ ì¡°íšŒ
    - ğŸ‘€ ì£¼ë¬¸ ì·¨ì†Œ
<br>
<br>
<br>
<br>

# ğŸ“Œí™ˆ í™”ë©´
## í™ˆ ì»¨íŠ¸ë¡¤ëŸ¬
~~~java
package jpabook.jpashop.controller;

import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@Slf4j
public class HomeController {

    @RequestMapping("/")
    public String home(){
        log.trace("íŠ¸ë ˆì´ìŠ¤ ë¡œê¹…");
        log.warn("ê²½ê³  ë¡œê¹…");
        log.info("ì •ë³´ ë¡œê¹…");
        log.debug("ë””ë²„ê¹…ìš© ë¡œê·¸");
        log.error("ì—ëŸ¬ë¡œê·¸");
        log.info("HomeController, í…ŒìŠ¤íŠ¸ ë³´ì´ë‚˜");
        return "home";
    }
}

~~~
![@Slf4j](https://user-images.githubusercontent.com/89888075/172768490-eaa7bcaf-f9a2-4388-ad60-65b8df45d76d.png)
### @Slf4jë¥¼ ì´ìš©í•´ì„œ ìœ„ ì™€ê°™ì´ ë¡œê·¸ë¥¼ í™•ì¸í•´ ë³¼ìˆ˜ ìˆë‹¤.
<br>
<br>

## home.html
~~~HTML
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header">
 <title>Hello</title>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
<div class="container">
 <div th:replace="fragments/bodyHeader :: bodyHeader" />
 <div class="jumbotron">
 <h1>HELLO SHOP</h1>
 <p class="lead">íšŒì› ê¸°ëŠ¥</p>
 <p>
 <a class="btn btn-lg btn-secondary" href="/members/new">íšŒì› ê°€ì…</a>
 <a class="btn btn-lg btn-secondary" href="/members">íšŒì› ëª©ë¡</a>
 </p>
 <p class="lead">ìƒí’ˆ ê¸°ëŠ¥</p>
 <p>
 <a class="btn btn-lg btn-dark" href="/items/new">ìƒí’ˆ ë“±ë¡</a>
 <a class="btn btn-lg btn-dark" href="/items">ìƒí’ˆ ëª©ë¡</a>
 </p>
 <p class="lead">ì£¼ë¬¸ ê¸°ëŠ¥</p>
 <p>
 <a class="btn btn-lg btn-info" href="/order">ìƒí’ˆ ì£¼ë¬¸</a>
 <a class="btn btn-lg btn-info" href="/orders">ì£¼ë¬¸ ë‚´ì—­</a>
 </p>
 </div>
 <div th:replace="fragments/footer :: footer" />
</div> <!-- /container -->
</body>
</html>
~~~
<br>
<br>

## fragments/header
~~~html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="header">
 <!-- Required meta tags -->
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1, shrinkto-fit=no">
 <!-- Bootstrap CSS -->
 <link rel="stylesheet" href="/css/bootstrap.min.css" integrity="sha384-
ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
crossorigin="anonymous">
 <!-- Custom styles for this template -->
 <link href="/css/jumbotron-narrow.css" rel="stylesheet">
 <title>Hello, world!</title>
</head>
~~~
<br>
<br>

## fragments/bodyHeader
~~~html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div class="header" th:fragment="bodyHeader">
 <ul class="nav nav-pills pull-right">
 <li><a href="/">Home</a></li>
 </ul>
 <a href="/"><h3 class="text-muted">HELLO SHOP</h3></a>
</div>
~~~
~~~html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div class="footer" th:fragment="footer">
 <p>&copy; Hello Shop V2</p>
</div>
~~~
<br>
<br>

## ë·° ë¦¬ì†ŒìŠ¤ ë“±ë¡
## jumbotron-narrow.css íŒŒì¼
~~~css
/* Space out content a bit */
body {
 padding-top: 20px;
 padding-bottom: 20px;
}
/* Everything but the jumbotron gets side spacing for mobile first views */
.header,
.marketing,
.footer {
 padding-left: 15px;
 padding-right: 15px;
}
/* Custom page header */
.header {
 border-bottom: 1px solid #e5e5e5;
}
/* Make the masthead heading the same height as the navigation */
.header h3 {
 margin-top: 0;
 margin-bottom: 0;
 line-height: 40px;
 padding-bottom: 19px;
}
/* Custom page footer */
.footer {
 padding-top: 19px;
 color: #777;
 border-top: 1px solid #e5e5e5;
}
/* Customize container */
@media (min-width: 768px) {
 .container {
 max-width: 730px;
 }
}
.container-narrow > hr {
 margin: 30px 0;
}
/* Main marketing message and sign up button */
.jumbotron {
 text-align: center;
 border-bottom: 1px solid #e5e5e5;
}
.jumbotron .btn {
 font-size: 21px;
 padding: 14px 24px;
}
/* Supporting marketing content */
.marketing {
 margin: 40px 0;
}
.marketing p + h4 {
 margin-top: 28px;
}
/* Responsive: Portrait tablets and up */
@media screen and (min-width: 768px) {
 /* Remove the padding we set earlier */
 .header,
 .marketing,
 .footer {
 padding-left: 0;
 padding-right: 0;
 }
 /* Space out the masthead */
 .header {
 margin-bottom: 30px;
 }
 /* Remove the bottom border on the jumbotron for visual effect */
 .jumbotron {
 border-bottom: 0;
 }
}
~~~
## ê²°ê³¼ í™”ë©´
![í—¬ë¡œìˆ í™ˆ](https://user-images.githubusercontent.com/89888075/172768508-6e5dc56d-2a29-4869-8373-65e62407d87f.png)

## ğŸ‘€ íšŒì› ê¸°ëŠ¥

## ğŸ‘€ íšŒì› ë“±ë¡
## íšŒì› ë“±ë¡ í¼ ê°ì²´
~~~java
package jpabook.jpashop.controller;

import lombok.Getter;
import lombok.Setter;

import javax.validation.constraints.NotEmpty;

@Getter
@Setter

public class MemberForm {

    @NotEmpty(message = "íšŒì› ì´ë¦„ì„ ê¸°ì…í•´ ì£¼ì„¸ìš”")
    //ìŠ¤í”„ë§ë¶€íŠ¸ 2.3ë¶€í„°ëŠ” implementation 'org.springframework.boot:spring-boot-starter-validation' ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì•¼ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤.
    private String name;

    @NotEmpty(message = "ë„ì‹œëª…ì„ ê¸°ì…í•´ ì£¼ì„¸ìš”")
    private String city;

    @NotEmpty(message = "ê±°ë¦¬ëª…ì„ ê¸°ì…í•´ ì£¼ì„¸ìš”")
    private String street;

    @NotEmpty(message = "ìš°í¸ë²ˆí˜¸ë¥¼ ê¸°ì…í•´ ì£¼ì„¸ìš”")
    private String zipcode;


}

~~~
## âœ @NotEmpty
- Bean validationì´ ì œê³µí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.
-  javax.validation.constraints.NotEmpty ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ê°€ ë¹„ì–´ì–´ìˆì„ ê²½ìš°ë¥¼ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ìŠ¤í”„ë§ë¶€íŠ¸ 2.3ë¶€í„°ëŠ” implementation 'org.springframework.boot:spring-boot-starter-validation' ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì•¼ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤.
<br>
<br>
<br>

## íšŒì› ë“±ë¡ ì»¨íŠ¸ë¡¤ëŸ¬
~~~java
package jpabook.jpashop.controller;

import jpabook.jpashop.domain.Address;
import jpabook.jpashop.domain.Member;
import jpabook.jpashop.service.MemberService;
import lombok.RequiredArgsConstructor;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;

import javax.validation.Valid;


@Controller
@RequiredArgsConstructor
public class MemberController {


    private  final MemberService memberService;

    @GetMapping(value = "/members/new")
    public String createForm(Model model) {
        model.addAttribute("memberForm", new MemberForm());
        return "members/createMemberForm";
    }

    @PostMapping("/members/new")
    public String create(@Valid MemberForm form, BindingResult result){

        if(result.hasErrors()){
            return "members/createMemberForm";
        }

        Address address = new Address(form.getCity(), form.getStreet(), form.getZipcode());
        Member member = new Member();
        member.setName(form.getName());
        member.setAddress(address);

        memberService.join(member);

        return "redirect:/";
    }
}

~~~
## âœ ë©¤ë²„ í¼ì„ ë”°ë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ì´ìœ .
- model.addAttribute("memberForm", new MemberForm());
- Member ê°ì²´ëŒ€ì‹  MemberFormì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” ì´ìœ ëŠ”
ì—”í‹°í‹° ì†ŒìŠ¤ê°€ @NotEmptyê°™ì€ ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•˜ë©´ì„œ ì§€ì €ë¶„í•´ì§ˆìˆ˜
ìˆë‹¤.
- í™”ë©´ì—ì„œì˜ í¼ ë°ì´í„°ì™€ ì—”í‹°í‹° ë°ì´í„°ì™€ ë§ì§€ì•Šì•„ì„œ ì°¨ë¼ë¦¬ í™”ë©´ì— ë”±
ë§ëŠ” í¼ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì„œ ë°ì´í„°ë¥¼ ë°›ëŠ”ê²Œ ë‚«ê¸°ë•Œë¬¸ì´ë‹¤.
- ì‹¤ë¬´ì—ì„œëŠ” ê°„ë‹¨í•œ í¼ ë°ì´í„°ë¥¼ ê°–ëŠ”ê²½ìš°ëŠ” ê±°ì˜ ì—†ê¸° ë–„ë¬¸ì— í¼ë°ì´í„°ë¥¼
ë”°ë¡œ ë§Œë“¤ì–´ì„œ ê´€ë¦¬í•œë‹¤.
## âœModel ì´ë€?
- import org.springframework.ui.Model;
- Modelì€ HashMap í˜•íƒœë¥¼ ê°–ê³  ìˆìœ¼ë©°, Key,Valueê°’ì„ ê°€ì§€ê³  ìˆë‹¤.
- addAttribute() ì™€ ê°™ì€ ê¸°ëŠ¥ì„ í†µí•´ ëª¨ë¸ì— ì›í•˜ëŠ” ì†ì„±ê³¼ ê·¸ê²ƒì—ëŒ€í•œ  ê°’ì„ ì£¼ì–´ ë·°ì— ë°ì´í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.
- Springì—ì„œ Controllerì˜ ë©”ì„œë“œë¥¼ ì‘ì„±í•  ë•Œ Modelì„ íƒ€ì…ì˜ íŒŒë¼ë¯¸í„°ë¡œ ì§€ì •ì´ ê°€ëŠ¥í•˜ë‹¤.
- Model ê°ì²´ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ìƒì„±ëœ ë°ì´í„°ë¥¼ ë‹´ì•„ì„œ í”„ë¡ íŠ¸ì— ì „ë‹¬í•´ ì¤€ë‹¤. 

## ğŸ‘€ íšŒì› ì¡°íšŒ
## íšŒì› ëª©ë¡ ì»¨íŠ¸ë¡¤ëŸ¬ ì¶”ê°€
- ê¸°ì¡´ MemberController ì•„ë˜ì˜ ì½”ë“œë§Œ ì¶”ê°€ í–ˆë‹¤.
~~~java
...

    //íšŒì› ëª©ë¡ ì»¨íŠ¸ë¡¤ëŸ¬
    @GetMapping("members")
    public String create(Model model){
        List<Member> members = memberService.findMember();
        model.addAttribute("members", members);
        return "members/memberList";
    }
~~~
<br>
<br>

## íšŒì› ëª©ë¡ ë·°( templates/members/memberList.html)
~~~html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header" />
<body>
<div class="container">
    <div th:replace="fragments/bodyHeader :: bodyHeader" />
    <div>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>#</th>
                <th>ì´ë¦„</th>
                <th>ë„ì‹œ</th>
                <th>ì£¼ì†Œ</th>
                <th>ìš°í¸ë²ˆí˜¸</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="member : ${members}">
                <td th:text="${member.id}"></td>
                <td th:text="${member.name}"></td>
                <td th:text="${member.address?.city}"></td>
                <td th:text="${member.address?.street}"></td>
                <td th:text="${member.address?.zipcode}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div th:replace="fragments/footer :: footer" />
</div> <!-- /container -->
</body>
</html>
~~~
<br>

## âœ th:each="member : ${members}" ì˜ ì˜ë¯¸
- ìë°”ì˜ for(member : members)ì˜ ì˜ë¯¸ì´ë©° ë¦¬ìŠ¤íŠ¸ë¥¼ membersì˜ ê¸¸ì´ë§Œí¼ memberë‹´ì•„ì„œ ë¿Œë ¤ì¤€ë‹¤.
<br>
<br>

## âœ íƒ€ì„ë¦¬í”„ë¬¸ë²•"?"
- íƒ€ì„ë¦¬í”„ì—ì„œ ? ì‚¬ìš©í•˜ë©´ nullì„ ë¬´ì‹œí•œë‹¤.
<br>
<br>

## âœ ì°¸ê³ : í¼ ê°ì²´ vs ì—”í‹°í‹° ì§ì ‘ ì‚¬ìš©<br>
- ìš”êµ¬ì‚¬í•­ì´ ì •ë§ ë‹¨ìˆœí•  ë•ŒëŠ” í¼ ê°ì²´( MemberForm ) ì—†ì´ ì—”í‹°í‹°( Member )ë¥¼ ì§ì ‘ ë“±ë¡ê³¼ ìˆ˜ì • í™”ë©´
ì—ì„œ ì‚¬ìš©í•´ë„ ëœë‹¤. 
- í•˜ì§€ë§Œ í™”ë©´ ìš”êµ¬ì‚¬í•­ì´ ë³µì¡í•´ì§€ê¸° ì‹œì‘í•˜ë©´, ì—”í‹°í‹°ì— í™”ë©´ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ê¸°ëŠ¥ì´
ì ì  ì¦ê°€í•œë‹¤. 
- ê²°ê³¼ì ìœ¼ë¡œ ì—”í‹°í‹°ëŠ” ì ì  í™”ë©´ì— ì¢…ì†ì ìœ¼ë¡œ ë³€í•˜ê³ , ì´ë ‡ê²Œ í™”ë©´ ê¸°ëŠ¥ ë•Œë¬¸ì— ì§€ì €ë¶„í•´ì§„
ì—”í‹°í‹°ëŠ” ê²°êµ­ ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì–´ë ¤ì›Œì§„ë‹¤.
- ì‹¤ë¬´ì—ì„œ ì—”í‹°í‹°ëŠ” í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ ê°€ì§€ê³  ìˆê³ , í™”ë©´ì„ ìœ„í•œ ë¡œì§ì€ ì—†ì–´ì•¼ í•œë‹¤. 
- í™”ë©´ì´ë‚˜ APIì— ë§ëŠ” í¼ ê°ì²´ë‚˜ DTOë¥¼ ì‚¬ìš©í•˜ì. 
- ê·¸ë˜ì„œ í™”ë©´ì´ë‚˜ API ìš”êµ¬ì‚¬í•­ì„ ì´ê²ƒë“¤ë¡œ ì²˜ë¦¬í•˜ê³ , ì—”í‹°í‹°ëŠ” ìµœëŒ€í•œ ìˆœìˆ˜
í•˜ê²Œ ìœ ì§€í•˜ì
<br>
<br>
<br>
<br>

# ğŸ“Œìƒí’ˆ ê¸°ëŠ¥
## ğŸ‘€ ìƒí’ˆ ë“±ë¡
## BookForm
- ë©¤ë²„í¼ê³¼ ê°™ì€ì´ìœ ë¡œ ì£¼ë¬¸ìƒì„±í™”ë©´ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë§Œ ê°–ê³ ìˆëŠ” í¼ì„ ë”°ë¡œ ë§Œë“¤ì–´ ì„œë²„ì™€ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆë‹¤.

~~~java
package jpabook.jpashop.controller;

import lombok.Getter;
import lombok.Setter;

@Getter@Setter
public class BookForm {

    //ìƒí’ˆ ìˆ˜ì •ì‹œ id í•„ìš”
    private Long id;
    //ì´ë¦„
    private String name;

    //ê°€ê²©
    private int price;

    //ì¬ê³ 
    private int stockQuantity;

    //ì‘ê°€
    private String author;

    //isbn
    private String isbn;
}

~~~
<br>
<br>
<br>

## ì•„ì´í…œ ì»¨íŠ¸ë¡¤ëŸ¬
~~~java
package jpabook.jpashop.controller;

import jpabook.jpashop.domain.item.Book;
import jpabook.jpashop.domain.item.Item;
import jpabook.jpashop.service.ItemService;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;


import java.util.List;


@Controller
@RequiredArgsConstructor
public class ItemController {

    private final ItemService itemService;

    //1.ìƒí’ˆ ë“±ë¡í˜ì´ì§€ ë¦¬í„´
    @GetMapping("/items/new")
    public String createItems(Model model) {

        model.addAttribute("form",new BookForm());

        return "items/createItemForm";
    }

    //2.ìƒí’ˆë“±ë¡ ë°ì´í„° ì €ì¥
    @PostMapping("items/new")
    public String create(BookForm form){

        Book book = new Book();
        book.setName(form.getName());
        book.setPrice(form.getPrice());
        book.setStockQuantity(form.getStockQuantity());
        book.setAuthor(form.getAuthor());
        book.setIsbn(form.getIsbn());

        itemService.saveItem(book);

        return "redirect:/";

    }

    //3.ìƒí’ˆ ëª©ë¡ ë¿Œë¦¬ê¸°
    @GetMapping(value = "/items")
    public String  itemList(Model model) {

        List<Item> items = itemService.finItem();
        model.addAttribute("items",items);

        return "items/itemlist";
    }

}

~~~
## âœ 1.ìƒí’ˆ ë“±ë¡í˜ì´ì§€ ë¦¬í„´
-  model.addAttribute()ì„ ì´ìš©í•´ì„œ í‚¤ì™€ ê°’ìœ¼ë¡œ ë¶í¼ê°ì²´ë¥¼ ë‹´ì•„ì„œ ìƒí’ˆë“±ë¡í˜ì´ì§€ ë¦¬í„´
<br>

## âœ 2.ìƒí’ˆ ë“±ë¡í˜ì´ì§€ ë¦¬í„´
- ìƒí’ˆ ë“±ë¡í¼ì—ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ Submitë²„íŠ¼ í´ë¦­ì‹œ í¬ìŠ¤íŠ¸ ë°©ì‹ìœ¼ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì „ë‹¬í›„ ì „ë‹¬ë°›ì€ ë°ì´í„°ë¥¼ ê·¼ê±°ë¡œ ìƒí’ˆ ì €ì¥ í›„ return "redirect:/" ìƒí’ˆ ëª©ë¡í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
<br>

## âœ 3.ìƒí’ˆ ëª©ë¡ ë¿Œë¦¬ê¸°
- itemService.finItem() ë¡œì§ìœ¼ë¡œ ì°¾ì€ ìƒí’ˆì„ ë¦¬ìŠ¤íŠ¸ íƒ€ì…ìœ¼ë¡œ ì €ì¥í›„ model.addAttribute() ë¥¼ ì´ìš©í•´ì„œ ìƒí’ˆì´ ë‹´ê¸´ ê°ì²´ë¥¼ return "items/itemlist" ë¡œ ì‘ë‹µí•´ì¤€ë‹¤.

## ìƒí’ˆ ë“±ë¡ ë·°
~~~html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header" />
<body>
<div class="container">
 <div th:replace="fragments/bodyHeader :: bodyHeader"/>
 <form th:action="@{/items/new}" th:object="${form}" method="post">
 <div class="form-group">
 <label th:for="name">ìƒí’ˆëª…</label>
 <input type="text" th:field="*{name}" class="form-control"
placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
 </div>
 <div class="form-group">
 <label th:for="price">ê°€ê²©</label>
 <input type="number" th:field="*{price}" class="form-control"
placeholder="ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”">
 </div>
 <div class="form-group">
 <label th:for="stockQuantity">ìˆ˜ëŸ‰</label>
 <input type="number" th:field="*{stockQuantity}" class="formcontrol" placeholder="ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”">
 </div>
 <div class="form-group">
 <label th:for="author">ì €ì</label>
 <input type="text" th:field="*{author}" class="form-control"
placeholder="ì €ìë¥¼ ì…ë ¥í•˜ì„¸ìš”">
 </div>
 <div class="form-group">
 <label th:for="isbn">ISBN</label>
 <input type="text" th:field="*{isbn}" class="form-control"
placeholder="ISBNì„ ì…ë ¥í•˜ì„¸ìš”">
 </div>
 <button type="submit" class="btn btn-primary">Submit</button>
 </form>
 <br/>
 <div th:replace="fragments/footer :: footer" />
</div> <!-- /container -->
</body>
</html>
~~~
## ìƒí’ˆ ëª©ë¡ ë·°
~~~html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header" />
<body>
<div class="container">
 <div th:replace="fragments/bodyHeader :: bodyHeader"/>
 <div>
 <table class="table table-striped">
 <thead>
 <tr>
 <th>#</th>
 <th>ìƒí’ˆëª…</th>
 <th>ê°€ê²©</th>
 <th>ì¬ê³ ìˆ˜ëŸ‰</th>
 <th></th>
 </tr>
 </thead>
 <tbody>
 <tr th:each="item : ${items}">
 <td th:text="${item.id}"></td>
 <td th:text="${item.name}"></td>
 <td th:text="${item.price}"></td>
 <td th:text="${item.stockQuantity}"></td>
 <td>
 <a href="#" th:href="@{/items/{id}/edit (id=${item.id})}"
class="btn btn-primary" role="button">ìˆ˜ì •</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>
 <div th:replace="fragments/footer :: footer"/>
</div> <!-- /container -->
</body>
</html>
~~~
## ğŸ‘€ ìƒí’ˆ ìˆ˜ì •
## ìƒí’ˆìˆ˜ì • ì»¨íŠ¸ë¡¤ëŸ¬ ì½”ë“œ
~~~java
package jpabook.jpashop.controller;

import jpabook.jpashop.domain.item.Book;
import jpabook.jpashop.domain.item.Item;
import jpabook.jpashop.service.ItemService;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;


import java.util.List;


@Controller
@RequiredArgsConstructor
public class ItemController {

    //ìƒí’ˆ ìˆ˜ì • í¼ì´ë™
    @GetMapping("items/{itemId}/edit")
    public String updateItemForm(@PathVariable("itemId") Long itemId, Model model) {
        Book item = (Book) itemService.findOne(itemId);

        BookForm form = new BookForm();
        form.setId(item.getId());
        form.setName(item.getName());
        form.setPrice(item.getPrice());
        form.setStockQuantity(item.getStockQuantity());
        form.setAuthor(item.getAuthor());
        form.setIsbn(item.getIsbn());

        model.addAttribute("form", form);

        return "items/updateItemForm";
    }

    //ìƒí’ˆ ìˆ˜ì •
    @PostMapping("items/{itemId}/edit")
    public String updateItem(@ModelAttribute("form") BookForm form) {

        Book book = new Book();
        book.setId(form.getId());
        book.setName(form.getName());
        book.setPrice(form.getPrice());
        book.setStockQuantity(form.getStockQuantity());
        book.setAuthor(form.getAuthor());
        book.setIsbn(form.getIsbn());

        itemService.saveItem(book);

        return "redirect:/items";
    }
}
~~~
<br>
<br>

## ìƒí’ˆ ìˆ˜ì • í¼ í™”ë©´( items/updateItemForm )
~~~html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header" />
<body>
<div class="container">
 <div th:replace="fragments/bodyHeader :: bodyHeader"/>
 <form th:object="${form}" method="post">
 <!-- id -->
 <input type="hidden" th:field="*{id}" />
 <div class="form-group">
 <label th:for="name">ìƒí’ˆëª…</label>
 <input type="text" th:field="*{name}" class="form-control"
placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" />
 </div>
 <div class="form-group">
 <label th:for="price">ê°€ê²©</label>
 <input type="number" th:field="*{price}" class="form-control"
placeholder="ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”" />
 </div>
 <div class="form-group">
 <label th:for="stockQuantity">ìˆ˜ëŸ‰</label>
 <input type="number" th:field="*{stockQuantity}" class="form-
control" placeholder="ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”" />
 </div>
 <div class="form-group">
 <label th:for="author">ì €ì</label>
 <input type="text" th:field="*{author}" class="form-control" 
placeholder="ì €ìë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
 </div>
 <div class="form-group">
 <label th:for="isbn">ISBN</label>
 <input type="text" th:field="*{isbn}" class="form-control" 
placeholder="ISBNì„ ì…ë ¥í•˜ì„¸ìš”" />
 </div>
 <button type="submit" class="btn btn-primary">Submit</button>
 </form>
 <div th:replace="fragments/footer :: footer" />
</div> <!-- /container -->
</body>
</html>
~~~
## âœ ìƒí’ˆ ìˆ˜ì • í¼ ì´ë™
1. ìƒí’ˆ ëª©ë¡í¼ì—ì„œ ìˆ˜ì • ë²„íŠ¼ í´ë¦­ì‹œ ->/items/{itemId}/edit URLì„ GET ë°©ì‹ìœ¼ë¡œ ìš”ì²­
2. ì•„ì´í…œ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ updateItemForm() ì‹¤í–‰ ->itemService.findOne(itemId);í˜¸ì¶œí•˜ê³  ìˆ˜ì •í•  ì•„ì´í…œ ì¡°íšŒ
3.  model.addAttribute("form", form); = ì¡°íšŒ ê²°ê³¼ê³¼ë¥¼ ëª¨ë¸ ê°ì²´ì— ë‹´ì•„ì„œ -> items/updateItemForm ì „ë‹¬
## âœ ìƒí’ˆ ìˆ˜ì • ì‹¤í–‰
1. ìƒí’ˆ ìˆ˜ì •í¼ì—ì„œ ì •ë³´ìˆ˜ì • í›„ Submit í´ë¦­
2. /items/{itemId}/edit URLì„ POST ë°©ì‹ìœ¼ë¡œ ìš”ì²­í•˜ê³  updateItem() ë©”ì„œë“œë¥¼ ì‹¤í–‰
3. ê·¸ë¦¬ê³  ì»¨íŠ¸ë¡¤ëŸ¬ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ itme ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤ëŠ” ì¤€ì˜ì†ì„± ìƒíƒœë‹¤. ë”°ë¼ì„œ ìˆ˜ì •ì„ í•´ë„ ë³€ê²½ ê°ì§€ ê¸°ëŠ¥ì€ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.



<br>
<br>
<br>
<br>

# ğŸ“Œë³€ê²½ ê°ì§€ì™€ ë³‘í•©(marge) "**ì¤‘ìš”**"

## ì¤€ì˜ì†ì„± ì—”í‹°í‹°ë€?
- JPA(ì˜ì†ì„±ì»¨í…ìŠ¤íŠ¸)ê°€ ë” ì´ìƒ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ì—”í‹°í‹°
- DBì— í•œë²ˆ ì €ì¥ ë˜ì–´ì„œ ID(ì‹ë³„ìê°€)ìˆëŠ” ì—”í‹°í‹°
<br>
<br>
<br>

## ì¤€ì˜ì†ì„± ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” 2ê°€ì§€ ë°©ë²•
1. ë³€ê²½ ê°ì§€ ê¸°ëŠ¥ ì‚¬ìš© (Dirty Checking)
    - ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì—”í‹°í‹°ë¥¼ ë‹¤ì‹œ ì¡°íšŒí•œ í›„ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤.
2. ë³‘í•© ì‚¬ìš© (merge)
    - ë³‘í•©ì€ ì¤€ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë³€ê²½í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.
<br>
<br>
<br>

## ë³€ê²½ ê°ì§€ ê¸°ëŠ¥ ì‚¬ìš©(dirty checking)
~~~java
@Transactional
void update(Item itemParam) { //itemParam: íŒŒë¦¬ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ ì¤€ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°
 Item findItem = em.find(Item.class, itemParam.getId()); //ê°™ì€ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•œ
ë‹¤.
 findItem.setPrice(itemParam.getPrice()); //ë°ì´í„°ë¥¼ ìˆ˜ì •í•œë‹¤.
}
~~~
- ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì—”í‹°í‹°ë¥¼ ë‹¤ì‹œ ì¡°íšŒí•œ í›„ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤.
- ë³€ê²½í•  ì—”í‹°í‹°ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ê³  ->íŠ¸ë Œì­ì…˜ ì•ˆì—ì„œ ë‹¤ì‹œ ì—”í‹°í‹°ë¥¼ ì¡°íšŒ, ë³€ê²½í•  ê°’ ì„ íƒ -> íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹œì ì— ë”í‹°ì²´í‚¹ì„í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ë¥¼ ë‚ ë¦°ë‹¤.
<br>
<br>
<br>

## ë³‘í•© ì‚¬ìš©(merge)
~~~java
@Transactional
void update(Item itemParam) { //itemParam: íŒŒë¦¬ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ ì¤€ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°
 Item mergeItem = em.merge(item);
}
~~~
###  ë³‘í•© ë™ì‘ë°©ì‹ ìš”ì•½ ì •ë¦¬
1. ì¤€ì˜ì† ì—”í‹°í‹°ì˜ ì‹ë³„ì ê°’ìœ¼ë¡œ ì˜ì† ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•œë‹¤.
2. ì˜ì† ì—”í‹°í‹°ì˜ ê°’ì„ ì¤€ì˜ì† ì—”í‹°í‹°ì˜ ê°’ìœ¼ë¡œ ëª¨ë‘ êµì²´í•œë‹¤.(ë³‘í•©í•œë‹¤.)
3. íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹œì ì— ë³€ê²½ ê°ì§€ ê¸°ëŠ¥ì´ ë™ì‘í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— UPDATE SQLì´ ì‹¤í–‰
<br>
<br>

### ë³‘í•©ì‚¬ìš© ì£¼ì˜ ì 
- mergeë¥¼ ì‚¬ìš©ì‹œ ëª¨ë“ ë°ì´í„°(ì†ì„±)ì´ ë³€ê²½ë˜ì–´, ë³€ê²½ì‹œ ê°’ì´ ì—†ì„ ê²½ìš° Nullê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸ê°€ ë˜ì–´ ì‹¤ë¬´ì—ì„œ ìœ„í—˜í•˜ë‹¤.(ë³‘í•©ì€ ëª¨ë“  í•„ë“œë¥¼ êµì²´)
<br>
<br>

## ğŸ‘ **merge vs dirty Checking ì°¨ì´**
- ë³€ê²½ê°ì§€(dirtyChecking)ì„ ì‚¬ìš©í•˜ë©´ ì›í•˜ëŠ” ë°ì´í„°(ì†ì„±ë§Œ) ì„ íƒí•´ì„œ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆë‹¤.
- ë³‘í•©ì€ ëª¨ë“  ë°ì´í„°ê°€ ë¹„ì–´ìˆìœ¼ë©´ nullë¡œ ì—…ë°ì´íŠ¸í•˜ë©´ì„œ ëª¨ë“  í•„ë“œë¥¼ êµì²´í•œë‹¤.
## ğŸ‘ ê·¸ëƒ¥ ì—”í‹°í‹°ë¥¼ ë³€ê²½í•  ë•ŒëŠ” í•­ìƒ ë³€ê²½ê°ì§€ë¥¼ ì‚¬ìš©í•˜ì!
<br>
<br>
<br>
<br>

# ğŸ“Œì£¼ë¬¸ ê¸°ëŠ¥
## ğŸ‘€ ìƒí’ˆ ì£¼ë¬¸
## ğŸ‘€ ì£¼ë¬¸ ë‚´ì—­ ì¡°íšŒ
## ğŸ‘€ ì£¼ë¬¸ ì·¨ì†Œ
<br>
<br>
<br>
<br>

### REF
- https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-%ED%99%9C%EC%9A%A9-1