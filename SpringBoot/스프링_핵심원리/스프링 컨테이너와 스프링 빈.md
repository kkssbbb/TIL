# ëª©ì°¨
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
- ì»¨í…Œì´ë„ˆì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì¡°íšŒ
- ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ê¸°ë³¸
- ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ë™ì¼í•œ íƒ€ì…ì´ ë‘˜ ì´ìƒ
- ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ìƒì† ê´€ê³„
- BeanFactoryì™€ ApplicationContest
- ë‹¤ì–‘í•œ ì„¤ì • í˜•ì‹ ì§€ì› - ìë°” ì½”ë“œ,XML
- ìŠ¤í”„ë§ ë¹ˆ ì„¤ì • ë©”íƒ€ ì •ë³´ - BeanDefinition

<br>
<br>
<br>

# ğŸ“ŒìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±

~~~java
// ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
ApplicationContext ac //ì¸í„°í˜ì´ìŠ¤
 = new AnnotationConfigApplicationContext(AppConfig.class); //êµ¬í˜„ì²´(ë‹¤í˜•ì„± ì ìš©)
~~~
- ApplicationContextë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ê³  í•œë‹¤.
- ApplicationContextëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ ìë°” ì„¤ì • í´ë˜ìŠ¤ë¡œ ë§Œë“¤ ìˆ˜ ìˆê³ , XMLì„ ê¸°ë°˜ìœ¼ë¡œë„ ìë°” ì„¤ì • í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ ì§€ê¸ˆì€ ì˜ ì•ˆì“°ì¸ë‹¤ê³  í•œë‹¤.
- ì•„ë˜ ì½”ë“œì²˜ëŸ¼ AppConfig.classë¥¼ ì‚¬ìš©í–ˆë˜ ë°©ì‹ì´ ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ìë°” ì„¤ì • í´ë˜ìŠ¤ë¡œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“ ê²ƒì´ë‹¤.
~~~java
@Configuration
public class AppConfig {

    @Bean
    public MemberService memberService(){
        return new MemberServiceImp(memberRepository());
    }

 ...
~~~
> ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆëŠ” BeanFactory,ApplicationContextë¡œ êµ¬ë¶„í•´ì„œ ë§í•˜ì§€ë§Œ BeanFactoryë¥¼ ì§ì ‘ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ ApplicatrionContextë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ê³  ë§í•œë‹¤.

<br>
<br>
<br>

## 1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
![ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±](https://user-images.githubusercontent.com/89888075/165224758-2c6e724c-f3fe-4f0c-8e3d-859e262f491e.png)
- ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆì˜ êµ¬í˜„ì²´ì¸ AnnotationConfigApplicationContextë¡œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•  ë•ŒëŠ” êµ¬ì„± ì •ë³´ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„£ì£¼ì–´ì•¼í•´ì„œ AppConfig.classë¥¼ êµ¬ì„±ì •ë³´ë¡œ ì§€ì •

<br>

## 2. ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡
![ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡](https://user-images.githubusercontent.com/89888075/165226094-0d320a90-360c-4dac-ad8d-a675cbf6b226.png)

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ AppConfig.classì˜ ì •ë³´ë¥¼ ì‚¬ìš©í•´ì„œ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡ í•œë‹¤.

ë¹ˆ ì´ë¦„
- ë¹ˆ ì´ë¦„ì€ ë©”ì„œë“œ ì´ë¦„ì„ ì‚¬ìš©í•œë‹¤.
- ë¹ˆ ì´ë¦„ì„ ì§ì ‘ ë¶€ì—¬í•  ìˆ˜ ë„ ìˆë‹¤.
   - @Bean(name="ìƒˆë¡œ ë“±ë¡í•  ì´ë¦„")

<br>

## 3. ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì¤€ë¹„
![ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì¤€ë¹„](https://user-images.githubusercontent.com/89888075/165228574-af0fbc7d-7384-43cc-a8f7-5bacfe5773fb.png)

<br>

## 4. ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì™„ë£Œ
![ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • -ì™„ë£Œ](https://user-images.githubusercontent.com/89888075/165228578-f0fe7886-2bb3-46d0-b0ed-4759240b6236.png)

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì„¤ì • ì •ë³´ë¥¼ ì°¸ê³ í•´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…(DI)í•œë‹¤.
- ë‹¨ìˆœíˆ ìë°” ì½”ë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ, ì°¨ì´ê°€ìˆë‹¤. ì´ ì°¨ì´ëŠ” ë’· ë¶€ë¶„ ì‹±ê¸€í†¤ ì»¨í…Œì´ë„ˆì—ì„œ ì„¤ëª…ì´ ìˆë‹¤ê³  í•œë‹¤.

<br>

### ì •ë¦¬
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ë©´ ì„¤ì •(êµ¬ì„±)ì •ë³´ì¸ AppConfigë¥¼ ì°¸ê³ í•´ì„œ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ê³ , ì˜ì¡´ê´€ê³„ë„ ì„¤ì •í•´ ì¤€ë‹¤.
<br>
<br>
<br>

# ğŸ“Œì»¨í…Œì´ë„ˆì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì¡°íšŒ
 ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ì‹¤ì œ ìŠ¤í”„ë§ ë¹ˆë“¤ì´ ì˜ ë“±ë¡ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ ë³´ê¸°.
 ~~~java
package hello.core.beanfind;

import hello.core.AppConfig;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class ApplicationContextInfoTest {

    //AppConfig.class ì˜ ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

    @Test
    @DisplayName("ëª¨ë“  ë¹ˆ ì¶œë ¥í•˜ê¸°")
    void findAllBean() {

        String[] beanDefinitionNames = ac.getBeanDefinitionNames();
        // getBeanDefinitionNames()ìœ¼ë¡œ ë¹ˆ ê°ì²´ì´ë¦„ë“¤ì„ ëª¨ë‘ beanDefinitionNamesì— ë‹´ìŒ

        for (String beanDefinitionName : beanDefinitionNames) {
            Object bean = ac.getBean(beanDefinitionName);
            //beanDefinitionNameì˜ ê°ì²´ë“¤ì„ í•˜ë‚˜í•˜ë‚˜ Objectíƒ€ì…ì˜ ë³€ìˆ˜ì— ë‹´ìŒ
            System.out.println("Name = " + beanDefinitionName + "  ,object = " + bean);
        }
    }
        @Test
        @DisplayName("ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ ì¶œë ¥í•˜ê¸°")
        void findApplicationBean(){
            String[] beanDefinitionNames = ac.getBeanDefinitionNames();
            for (String beanDefinitionName : beanDefinitionNames) {
                BeanDefinition beanDefinition = ac.getBeanDefinition(beanDefinitionName);

                //Role ROLE_APPLICATION : ì§ì ‘ ë“±ë¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ
                //Role ROLE_INFRASTRUCTURE : ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ
                if(beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION){
                    Object bean = ac.getBean(beanDefinitionName);
                    System.out.println("name= " + beanDefinitionName + ", object= "+bean);
                }

        }
    }
}

~~~
- ëª¨ë“  ë¹ˆ ì¶œë ¥í•˜ê¸°
  - ì‹¤í–‰í™”ë©´ ìŠ¤í”„ë§ì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì •ë³´ë¥¼ ì¶œë ¥ í•  ìˆ˜ ìˆë‹¤.
- ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ ì¶œë ¥í•˜ê¸°
  - ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ ì œì™¸ ë‚´ê°€ ë“±ë¡í•œ ë¹ˆë§Œ ë³´ê¸°
  - Role ROLE_APPLICATIONì„ ì´ìš©í•´ì„œ ì§ì ‘ ë“±ë¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆì¼ë•Œë§Œ Object ë³€ìˆ˜ì— ë‹´ê¸°
<br>
<br>
<br>

# ğŸ“ŒìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ê¸°ë³¸
~~~java
package hello.core.beanfind;

import hello.core.AppConfig;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImp;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.NoSuchBeanDefinitionException;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.setRemoveAssertJRelatedElementsFromStackTrace;

public class ApplicationContextBasicFindTest {
    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

    @Test
    @DisplayName("ë¹ˆ ì´ë¦„ìœ¼ë¡œ ì¡°íšŒ")
    void ë¹ˆì´ë¦„ìœ¼ë¡œì¡°íšŒ(){
       MemberService memberService = ac.getBean("memberService", MemberService.class);
        System.out.println("memberService" + memberService);
        System.out.println("memberService.g1etClass() = " + memberService.getClass());
        assertThat(memberService).isInstanceOf(MemberServiceImp.class);
    }
    @Test
    @DisplayName("ì´ë¦„ì—†ì´ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ")
    void ì´ë¦„ì—†ì´íƒ€ì…ìœ¼ë¡œì¡°íšŒ(){
        MemberService memberService = ac.getBean(MemberService.class);
        assertThat(memberService).isInstanceOf(MemberServiceImp.class);
    }

    @Test
    @DisplayName("êµ¬ì²´ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ")
    void êµ¬ì²´íƒ€ì…ìœ¼ë¡œ(){
        MemberService memberService = ac.getBean("memberService", MemberServiceImp.class);
        assertThat(memberService).isInstanceOf(MemberServiceImp.class);
    }
    
    
    @Test //ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ NoSuchBeanDefinitionException ë°œìƒì‹œ í…ŒìŠ¤íŠ¸ ì„±ê³µ
    @DisplayName("ë¹ˆ ì´ë¦„ìœ¼ë¡œ ì¡°íšŒ x")
    void ë¹ˆì´ë¦„ìœ¼ë¡œì¡°íšŒx(){
        org.junit.jupiter.api.Assertions.assertThrows(NoSuchBeanDefinitionException.class,
                () -> ac.getBean("xxxx", MemberService.class));
     }
}

~~~
- getBean(ë¹ˆì´ë¦„, íƒ€ì…) or getBean(íƒ€ì…)
- ì¡°íšŒ ëŒ€ìƒ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìœ¼ë©´ ì˜ˆì™¸ ë°œìƒ
  - NoSuchBeanDefinitionException: No bean named 'xxxx' available
<br>
<br>
<br>

# ğŸ“ŒìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ë™ì¼í•œ íƒ€ì…ì´ ë‘˜ ì´ìƒ
~~~java
package hello.core.beanfind;

import hello.core.discount.DiscountPolicy;
import hello.core.member.MemberMemoryRepository;
import hello.core.member.MemberRepository;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

public class ApplicationContextSameBeanFindTest {

    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(SameBeanConfig.class);

    @Test
    @DisplayName("íƒ€ì…ìœ¼ë¡œ ì¡°íšŒì‹œ ê°™ì€ íƒ€ì…ì´ ë‘˜ ì´ìƒ ìˆìœ¼ë©´, ì¤‘ë³µ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.")

    void ê°™ì€íƒ€ì…ì¡°íšŒ() {
        MemberRepository bean = ac.getBean(MemberRepository.class);
        //NoUniqueBeanDefinitionException
    }



    @Configuration
    static class SameBeanConfig{
        @Bean
        public MemberRepository memberRepository1() {
            return new MemberMemoryRepository();
        }
        @Bean
        public MemberRepository memberRepository2() {
            return new MemberMemoryRepository();
        }
    }
}

~~~

NoUniqueBeanDefinitionException ì—ëŸ¬(ì˜ˆì™¸) ë°œìƒ

<br/>
<br/>

~~~java
  //íŠ¹ì •íƒ€ì… ëª¨ë‘ ì¡°íšŒí•˜ê¸°
    @Test
    @DisplayName("íŠ¹ì •íƒ€ì… ëª¨ë‘ ì¡°íšŒ")
    void AllFind(){
        Map<String, MemberRepository> beansOfType = ac.getBeansOfType(MemberRepository.class);
        for (String key : beansOfType.keySet()){
            System.out.println("key = " + key+ "value = " + beansOfType.get(key));
        }
        org.assertj.core.api.Assertions.assertThat(beansOfType.size()).isEqualTo(2);
    }
~~~
![íŠ¹ì •íƒ€ì… ëª¨ë‘ ì¡°íšŒ](https://user-images.githubusercontent.com/89888075/165452515-848c0a4b-8ed3-4d9b-9451-565dfd8887c3.PNG)

<br>
<br>
<br>

# ğŸ“ŒìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ìƒì† ê´€ê³„
~~~java
package hello.core.beanfind;

import hello.core.AppConfig;
import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.discount.RateDiscountPolicy;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.NoUniqueBeanDefinitionException;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.util.Map;

public class ApplicationContextExtendsFindTest {

    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(TestConfig.class);

    @Test
    @DisplayName("ê°™ì€ ë¶€ëª¨ íƒ€ì… ì¡°íšŒì‹œ ê²°ê³¼ í…ŒìŠ¤íŠ¸")
    void findSameExtendsTypeBean(){
 /*
   DiscountPolicy bean = ac.getBean(DiscountPolicy.class);
        System.out.println("bean = " + bean);
        ì˜ˆì™¸ ë°œìƒ : NoUniqueBeanDefinitionException
        */

        Assertions.assertThrows(NoUniqueBeanDefinitionException.class,
                ()->ac.getBean(DiscountPolicy.class));
        //junit5ì˜ assertThrows ì˜ˆì™¸ í…ŒìŠ¤íŠ¸ assertThrows ì²«ë²ˆì§¸ì¸ìì— ì˜ˆì™¸í´ë˜ìŠ¤ë“œë¥¼ ì¸ìë¡œ ë„£ì–´ì£¼ê³ 
        //ë‘ë²ˆì§¸ì¸ìì—” ì²«ë²ˆì§¸ ì¸ìì˜ ì˜ˆì™¸ íƒ€ì…ê³¼ ê°™ì€ì§€ í˜¹ì€ ìƒì†ê´€ê³„ì˜ ì˜ˆì™¸ì¸ì§€ ê²€ì‚¬í•œë‹¤.


    }

    @Test
    @DisplayName("ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒì‹œ, ìì‹ì´ ë‘˜ ì´ìƒ ìˆìœ¼ë©´, ë¹ˆ ì´ë¦„ì„ ì§€ì •í•˜ë©´ ëœë‹¤.")
    void ë¶€ëª¨íƒ€ì…ì¤‘ë³µ_ë¹ˆì´ë¦„ì§€ì •(){
        DiscountPolicy bean = ac.getBean("rateDiscountPolicy", DiscountPolicy.class);
        org.assertj.core.api.Assertions.assertThat(bean).isInstanceOf(RateDiscountPolicy.class);
    }

    @Test
    @DisplayName("íŠ¹ì • í•˜ìœ„ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ")
    void íŠ¹ì •í•˜ìœ„íƒ€ì…ì¡°íšŒ() {
        RateDiscountPolicy bean = ac.getBean(RateDiscountPolicy.class);
        org.assertj.core.api.Assertions.assertThat(bean).isInstanceOf(RateDiscountPolicy.class);
    }

    @Test
    @DisplayName("ë¶€ëª¨íƒ€ì…ìœ¼ë¡œ ëª¨ë“  ë¹ˆ ì¡°íšŒ")
    void ë¶€ëª¨íƒ€ì…ëª¨ë“ ë¹ˆì¡°íšŒ(){
        Map<String , DiscountPolicy> beansOfType= ac.getBeansOfType(DiscountPolicy.class);
        for(String key : beansOfType.keySet()){ //keySet() = í•´ë‹¹í´ë˜ìŠ¤ì˜ í‚¤ë¥¼ ë¦¬í„´
            System.out.println("key = " + key + "value = " +beansOfType.get(key) );
        }
    }

    @Test
    @DisplayName("ì˜¤ë¸Œì íŠ¸ íƒ€ì…ìœ¼ë¡œ ëª¨ë‘ ì¡°íšŒí•˜ê¸°")
    void ì˜¤ë¸Œì íŠ¸íƒ€ì…ìœ¼ë¡œëª¨ë‘ì¡°íšŒ(){
        Map<String,Object> beansOfType = ac.getBeansOfType(Object.class);
        for(String key : beansOfType.keySet()){
            System.out.println("key = " + key+ "  value = " +beansOfType.get(key));
        }
    }



    //ìƒì† ê´€ê³„ ë¹ˆ ì¡°íšŒ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í…ŒìŠ¤íŠ¸ ë¹ˆ ì»¨í…Œì´ë„ˆ
    @Configuration
    static class TestConfig{

        @Bean
        public DiscountPolicy rateDiscountPolicy() {
            return new RateDiscountPolicy();
        }

        @Bean
        public DiscountPolicy fixDiscountPolicy(){
            return new FixDiscountPolicy();
        }
    }
}

~~~
## í•™ìŠµí•œ ë‚´ìš©

### NoUniqueBeanDefinitionException
- ê°™ì€ ë¶€ëª¨íƒ€ì…ì˜ ë¹ˆì„ ì¡°íšŒì‹œ NoUniqueBeanDefinitionException ë°œìƒ
### junit5ì˜ assertThrows ì˜ˆì™¸ í…ŒìŠ¤íŠ¸ 
- assertThrows ì²«ë²ˆì§¸ì¸ìì— ì˜ˆì™¸í´ë˜ìŠ¤ë“œë¥¼ ì¸ìë¡œ ë„£ì–´ì£¼ê³  ë‘ë²ˆì§¸ì¸ìì—” ì²«ë²ˆì§¸ ì¸ìì˜ ì˜ˆì™¸ íƒ€ì…ê³¼ ê°™ì€ì§€ í˜¹ì€ ìƒì†ê´€ê³„ì˜ ì˜ˆì™¸ì¸ì§€ ê²€ì‚¬í•œë‹¤.
### Map Class ë©”ì„œë“œ
- keySet() : í´ë˜ìŠ¤í‚¤ë¥¼ ë¦¬í„´ë°›ìŒ

### AbstractApplicationContext í´ë˜ìŠ¤ ë©”ì„œë“œ
- getBean() : ì¸ìë¡œ ë°›ì€ í´ë˜ìŠ¤ì˜ ë¹ˆì„ ë¦¬í„´ë°›ëŠ”ë‹¤.
- getBeanOfType() : ì¸ìë¡œë°›ì€ í´ë˜ìŠ¤ì˜ í‚¤ì™€ ê°’ì„ ë¦¬í„´ë°›ëŠ”ë‹¤
<br>
<br>
<br>


# ë‹¤ì–‘í•œ ì„¤ì • í˜•ì‹ ì§€ì› - ìë°” ì½”ë“œ,XML
![xml ì»¨í”¼ê·¸](https://user-images.githubusercontent.com/89888075/165555806-0fe3bcec-c368-42be-9699-4a06f37ec7b9.PNG)

ì´ì „ì— ìë°”ì½”ë“œë¡œ ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í• ë•Œ 

 ApplicatoinContextì˜ êµ¬í˜„ê°ì²´ì¸ AnnotationConfigApplicationContext ë¥¼ ê°ì²´ë¡œ new í•´ì„œ ì‚¬ìš©í–ˆë‹¤.
 ê·¸ë¦¬ê³  ìŠ¤í”„ë§ì—ì„œëŠ” ìë°”ì½”ë“œë§ê³ ë„ xmlì„ ì´ìš©í•´ì„œ ë¹ˆì„ ë“±ë¡í•  ìˆ˜ ìˆì†Œ ì§ì ‘ êµ¬í˜„ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš© í•  ìˆ˜ ë„ ìˆë‹¤.<br>
 ì•„ë˜ì½”ë“œëŠ” GenericXmlApplicationContextë¥¼ êµ¬í˜„ê°ì²´ë¡œ ìƒì„±í•´ì„œ xmlìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•´ ë³´ì•˜ë‹¤.

~~~java
public class XmlAppContext {

    @Test
    void xmlAppContext(){
        ApplicationContext ac = new GenericXmlApplicationContext("appConfig.xml");
        //GenericXmlApplicationContext ì„ êµ¬í˜„ì²´ë¡œ ìƒì„±í•´ì„œ "appConfig.xml"ì„ ì¸ìë¡œ ë„£ì–´ì¤Œ
        MemberService memberService = ac.getBean("memberService", MemberService.class);
        System.out.println("memberService = " + memberService);
        Assertions.assertThat(memberService).isInstanceOf(MemberService.class);
    }
}
~~~

## appConfig.xml
~~~xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

<!-- ë¹ˆë“±ë¡ -->

    <bean id="memberService" class="hello.core.member.MemberServiceImp">
        <constructor-arg name="memberRepository" ref="memberRepository" />
    </bean>

    <bean id="memberRepository" class="hello.core.member.MemberMemoryRepository"/>

    <bean id="discountPolicy" class="hello.core.discount.RateDiscountPolicy"/>

    <bean id="orderService" class="hello.core.order.OrderServiceImpl">
           <constructor-arg name="discountPolicy" ref="discountPolicy"/>
           <constructor-arg name="memberRepository" ref="memberRepository"/>
    </bean>

</beans>
~~~

xml ì„¤ì •íŒŒì¼ë„ ìë°”ì„¤ì •í´ë˜ìŠ¤ì™€ ë¹„ìŠ·í•˜ê²Œ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
ì´ì²˜ëŸ¼ ìŠ¤í”„ë§ì€ ì„¤ì •íŒŒì¼ì„ ìœ ì—°í•˜ê²Œ ë³€ê²½ í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆëŠ”ê±°ê°™ë‹¤.

<br>
<br>
<br>

# ğŸ“ŒìŠ¤í”„ë§ ë¹ˆ ì„¤ì • ë©”íƒ€ ì •ë³´ - BeanDefinition
- ìŠ¤í”„ë§ì´ ë‹¤ì–‘í•œ ì„¤ì •í˜•ì‹ì„ ì§€ì›í•  ìˆ˜ ìˆëŠ” ì´ìœ ëŠ” **BeanDefinition** ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ **ì—­í• ê³¼ êµ¬ë¶€í˜„ì„ ê°œë…ì ìœ¼ë¡œ ë‚˜ëˆ„ì—ˆê¸° ë–„ë¬¸**ì´ë‹¤.
- ë”°ë¼ì„œ xmlì´ë“  ìë°”ì½”ë“œì˜ ë¹ˆ ì„¤ì • ì •ë³´ë“  êµ¬í˜„ì²´ë¥¼ ë§Œë“¤ì–´ì„œ  BeanDefinitionì„ ë§Œë“¤ë©´ ëœë‹¤.
- BeanDefinitionì€ **ë¹ˆ ì„¤ì • ë©”íƒ€ì •ë³´**ë¼ê³  í•œë‹¤.
  - @Bean, < bean > ë‹¹ ê°ê° í•˜ë‚˜ì”© ë©”íƒ€ì •ë³´ê°€ ìƒì„± ëœë‹¤.
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì´ ë©”íƒ€ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ìƒì„±í•œë‹¤.
>ë©”íƒ€ë°ì´í„°ë€ ë°ì´í„°ì— ëŒ€í•œ ë°ì´í„°ì´ë©° ì •í™•íˆëŠ” ì–´ë–¤ ëª©ì ì„ ê°€ì§€ê³  ë§Œë“¤ì–´ì§„ ë°ì´í„°ë¼ê³ ë„ ì •ì˜í•œë‹¤.
ì¦‰, ë©”íƒ€ë°ì´í„°ëŠ” ì–´ë– í•œ ë°ì´í„°ì˜ ì •ë³´(ë°ì´í„°)ë“¤ì„ ë‹´ê³ ìˆëŠ” ê²ƒì„ ë§í•˜ëŠ”ê²ƒ ê°™ë‹¤.<br>
ex) ì´ë¯¸ì§€íŒŒì¼ì´ ìˆì„ë•Œ ì´ë¯¸ì§€ì˜ í™•ì¥ì, í¬ê¸° ,ì´ë¦„, ìƒì„±ì¼, ë“±ì„ ë©”íƒ€ë°ì´í„°ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

![ë¹ˆë©”íƒ€ì •ë³´ì˜ì¡´ê¸°ë³¸](https://user-images.githubusercontent.com/89888075/165888247-1f2ca5b5-7841-4220-96ad-26a72a40062f.png)
![ë¹ˆë©”íƒ€ì •ë³´ìƒì„¸](https://user-images.githubusercontent.com/89888075/165888243-3355136d-14b5-4dc2-9aa0-1a6b9994fee0.png)

- **AnnotationConfigApplicationContext**ê°€ **AnnotatedBeanDefinitionReader**ë¥¼ ì‚¬ìš©í•´ì„œ **AppConfig.class**ì˜ ì„¤ì • ì •ë³´ë¥¼ ì½ê³  **BeanDefinition**ì„ ìƒì„±í•œë‹¤.
<br>
<br>


~~~java
package beanDefinition;

import hello.core.AppConfig;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class BeanDefinitionTest {

  AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

  @Test
  @DisplayName("ë¹ˆ ì„¤ì • ë©”íƒ€ì •ë³´ í™•ì¸")
  void ë¹ˆì„¤ì •ë©”íƒ€ì •ë³´í™•ì¸() {
    //ì»¨í…Œì´ë„ˆ ìƒì„±
    String[] beanDefinitionNames = ac.getBeanDefinitionNames();

    // ë°°ì—´ ë‹´ê¸´ bean ì´ë¦„ì„  beanDefinitionName ë‹´ìŒ
    for(String beanDefinitionName : beanDefinitionNames){

     BeanDefinition beanDefinition = ac.getBeanDefinition(beanDefinitionName);
      //íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ ë°°ì—´ì´ë¦„ì˜ ì •ë³´ë¥¼ êº¼ë„¤ì™€ì„œ beanDefinition ì—ë‹´ìŒ

      if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
        //beanDefinitionì˜ ì •ë³´ == BeanDefinitionì—ì„œ ì‚¬ìš©ìê°€ ì •ì˜í•œ ë¹ˆ
        System.out.println("beanDefinitionName = " + beanDefinitionName+ " beanDefinition = " + beanDefinition);

      }
    }
  }

}

~~~
### BeanDefinition ì‚´í´ë³´ê¸°

**BeanDefinition ì •ë³´**
-   

- **BeanClassName**: ìƒì„±í•  ë¹ˆì˜ í´ë˜ìŠ¤ ëª…(ìë°” ì„¤ì • ì²˜ëŸ¼ íŒ©í† ë¦¬ ì—­í• ì˜ ë¹ˆì„ ì‚¬ìš©í•˜ë©´ ì—†ìŒ)
- **factoryBeanName**: íŒ©í† ë¦¬ ì—­í• ì˜ ë¹ˆì„ ì‚¬ìš©í•  ê²½ìš° ì´ë¦„, ì˜ˆ) appConfig
- **factoryMethodName**: ë¹ˆì„ ìƒì„±í•  íŒ©í† ë¦¬ ë©”ì„œë“œ ì§€ì •, ì˜ˆ) memberService
- **Scope**: ì‹±ê¸€í†¤(ê¸°ë³¸ê°’)
- **lazyInit**: ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•  ë•Œ ë¹ˆì„ ìƒì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì‹¤ì œ ë¹ˆì„ ì‚¬ìš©í•  ë•Œ ê¹Œì§€ ìµœëŒ€í•œ
- ìƒì„±ì„ ì§€ì—°ì²˜ë¦¬ í•˜ëŠ”ì§€ ì—¬ë¶€
- **InitMethodName**: ë¹ˆì„ ìƒì„±í•˜ê³ , ì˜ì¡´ê´€ê³„ë¥¼ ì ìš©í•œ ë’¤ì— í˜¸ì¶œë˜ëŠ” ì´ˆê¸°í™” ë©”ì„œë“œ ëª…
- **DestroyMethodName**: ë¹ˆì˜ ìƒëª…ì£¼ê¸°ê°€ ëë‚˜ì„œ ì œê±°í•˜ê¸° ì§ì „ì— í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œ ëª…
- **Constructor** arguments, Properties: ì˜ì¡´ê´€ê³„ ì£¼ì…ì—ì„œ ì‚¬ìš©í•œë‹¤. (ìë°” ì„¤ì • ì²˜ëŸ¼ íŒ©í† ë¦¬
  ì—­í• ì˜ ë¹ˆì„ ì‚¬ìš©í•˜ë©´ ì—†ìŒ)

~~~

beanDefinitionName = appConfig 
beanDefinition = Generic bean: class [hello.core.AppConfig$$EnhancerBySpringCGLIB$$3013409a]; scope=singleton;
abstract=false; 
lazyInit=null; 
autowireMode=0; 
dependencyCheck=0; 
autowireCandidate=true; 
primary=false; 
factoryBeanName=null; 
factoryMethodName=null;
initMethodName=null;
 destroyMethodName=null



beanDefinitionName = memberService 
beanDefinition = Root bean: class [null];
 scope=;
abstract=false; 
lazyInit=null; 
autowireMode=3; 
dependencyCheck=0; 
autowireCandidate=true; 
primary=false; 
factoryBeanName=appConfig; 
factoryMethodName=memberService; 
initMethodName=null; 
destroyMethodName=(inferred); 
defined in hello.core.AppConfig
~~~
<br>
<br>
<br>


>Ref ê¹€ì˜í•œë‹˜ ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ê¸°ë³¸í¸